FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1hcmlhZGItZGVwbG95bWVudC1hcGIKZGVzY3JpcHRpb246IFRo\
aXMgaXMgYSBzYW1wbGUgYXBwbGljYXRpb24gZ2VuZXJhdGVkIGJ5IGFwYiBpbml0CmJpbmRhYmxl\
OiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IE1hcmlhREIg\
b24gdm0gKEFQQikKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhp\
cyBkZWZhdWx0IHBsYW4gZGVwbG95cyBtYXJpYWRiLWRlcGxveW1lbnQtYXBiCiAgICBmcmVlOiBU\
cnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogZGJuYW1l\
IAogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBuYW1lIHRvIGNyZWF0ZSBvbiBqdXN0IGNyZWF0ZWQg\
bWFyaWFkYgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IG15YXBwZGIKICAg\
ICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHJvb3RwYXNzd29yZAogICAgICAgIHRp\
dGxlOiBEYXRhYmFzZSByb290IHBhc3N3b3JkIHRvIHNldAogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIGRlZmF1bHQ6IFIzZGg0dDEhCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBk\
aXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIC0gbmFtZTogdGFyZ2V0X2hvc3QKICAgICAgICB0\
aXRsZTogVGFyZ2V0IEhvc3QgZm9yIHByb3Zpc2lvbmluZwogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIGRlZmF1bHQ6IDE3Mi4xNi4wLjcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAt\
IG5hbWU6IHJlbW90ZXVzZXIKICAgICAgICB0aXRsZTogU1NIIFJlbW90ZSBVc2VyCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogdXNlcgogICAgICAgIHJlcXVpcmVkOiB0cnVl\
CiAgICAgIC0gbmFtZTogc3NocHJpdmtleQogICAgICAgIHRpdGxlOiBTU0ggUHJpdmF0ZSBrZXkg\
Zm9yIGNvbm5lY3RpbmcgdG8gdGhlIHJlbW90ZSBtYWNoaW5lCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCgo="

















COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN echo "host_key_checking = False" >> /opt/apb/ansible.cfg
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
